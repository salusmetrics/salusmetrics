(()=>{"use strict";let t;const e=new Uint8Array(16);function n(){if(!t){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");t=crypto.getRandomValues.bind(crypto)}return t(e)}const s=[];for(let t=0;t<256;++t)s.push((t+256).toString(16).slice(1));const i={};function r(t,e,n,s,i=0){if(t.length<16)throw new Error("Random bytes length must be >= 16");if(s){if(i<0||i+16>s.length)throw new RangeError(`UUID byte range ${i}:${i+15} is out of buffer bounds`)}else s=new Uint8Array(16),i=0;return e??=Date.now(),n??=127*t[6]<<24|t[7]<<16|t[8]<<8|t[9],s[i++]=e/1099511627776&255,s[i++]=e/4294967296&255,s[i++]=e/16777216&255,s[i++]=e/65536&255,s[i++]=e/256&255,s[i++]=255&e,s[i++]=112|n>>>28&15,s[i++]=n>>>20&255,s[i++]=128|n>>>14&63,s[i++]=n>>>6&255,s[i++]=n<<2&255|3&t[10],s[i++]=t[11],s[i++]=t[12],s[i++]=t[13],s[i++]=t[14],s[i++]=t[15],s}const o=function(t,e,o){let c;if(t)c=r(t.random??t.rng?.()??n(),t.msecs,t.seq,e,o);else{const t=Date.now(),s=n();!function(t,e,n){t.msecs??=-1/0,t.seq??=0,e>t.msecs?(t.seq=n[6]<<23|n[7]<<16|n[8]<<8|n[9],t.msecs=e):(t.seq=t.seq+1|0,0===t.seq&&t.msecs++)}(i,t,s),c=r(s,i.msecs,i.seq,e,o)}return e?c:function(t,e=0){return(s[t[e+0]]+s[t[e+1]]+s[t[e+2]]+s[t[e+3]]+"-"+s[t[e+4]]+s[t[e+5]]+"-"+s[t[e+6]]+s[t[e+7]]+"-"+s[t[e+8]]+s[t[e+9]]+"-"+s[t[e+10]]+s[t[e+11]]+s[t[e+12]]+s[t[e+13]]+s[t[e+14]]+s[t[e+15]]).toLowerCase()}(c)};var c,u;!function(t){t[t.Visitor=1]="Visitor",t[t.Session=2]="Session",t[t.Section=3]="Section",t[t.Click=4]="Click"}(c||(c={})),function(t){t[t.BadRequest=0]="BadRequest",t[t.InternalServerError=1]="InternalServerError",t[t.Timeout=2]="Timeout"}(u||(u={}));let a=new class{constructor(){this.event_type=c.Visitor,this.id=o()}toClientEvent(){return{t:this.event_type,i:this.id,a:void 0}}},h=new class{constructor(t){this.event_type=c.Session,this.id=o(),this.parent=t}toClientEvent(){const t={parent:this.parent.id};return{t:this.event_type,i:this.id,a:t}}}(a),p=new class{constructor(t){this.event_type=c.Section,this.id=o(),this.parent=t}toClientEvent(){const t={parent:this.parent.id};return{t:this.event_type,i:this.id,a:t}}}(h),l=new class{constructor(t){this.event_type=c.Click,this.id=o(),this.parent=t}toClientEvent(){const t={parent:this.parent.id};return{t:this.event_type,i:this.id,a:t}}}(p);new class{constructor(t,e){this.api_key=t,this.endpoint=e+"/multi"}publish(t){return e=this,n=void 0,i=function*(){const e=yield fetch(this.createRequest(t));return e.ok?{count:t.length}:500==e.status?u.InternalServerError:400==e.status?u.BadRequest:u.Timeout},new((s=void 0)||(s=Promise))((function(t,r){function o(t){try{u(i.next(t))}catch(t){r(t)}}function c(t){try{u(i.throw(t))}catch(t){r(t)}}function u(e){var n;e.done?t(e.value):(n=e.value,n instanceof s?n:new s((function(t){t(n)}))).then(o,c)}u((i=i.apply(e,n||[])).next())}));var e,n,s,i}createRequest(t){return new Request(this.endpoint,{method:"POST",mode:"cors",headers:{"content-type":"application/json","api-key":this.api_key},body:JSON.stringify(t.map((t=>t.toClientEvent())))})}}("abc-xyz","http://localhost:3000").publish([a,h,p,l])})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q2UsUUFBUSxDQUFDckIsRUFBU1UsRUFBU0ksRUFBU0UsRyIsInNvdXJjZXMiOlsid2VicGFjazovL2luZ2VzdC1jbGllbnQvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3JuZy5qcyIsIndlYnBhY2s6Ly9pbmdlc3QtY2xpZW50Ly4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9zdHJpbmdpZnkuanMiLCJ3ZWJwYWNrOi8vaW5nZXN0LWNsaWVudC8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvdjcuanMiLCJ3ZWJwYWNrOi8vaW5nZXN0LWNsaWVudC8uL3NyYy9FdmVudHMudHMiLCJ3ZWJwYWNrOi8vaW5nZXN0LWNsaWVudC8uL3NyYy9FdmVudFB1Ymxpc2hlci50cyIsIndlYnBhY2s6Ly9pbmdlc3QtY2xpZW50Ly4vc3JjL2luZGV4LnRzIiwid2VicGFjazovL2luZ2VzdC1jbGllbnQvLi9zcmMvSHR0cEV2ZW50UHVibGlzaGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImxldCBnZXRSYW5kb21WYWx1ZXM7XG5jb25zdCBybmRzOCA9IG5ldyBVaW50OEFycmF5KDE2KTtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHJuZygpIHtcbiAgICBpZiAoIWdldFJhbmRvbVZhbHVlcykge1xuICAgICAgICBpZiAodHlwZW9mIGNyeXB0byA9PT0gJ3VuZGVmaW5lZCcgfHwgIWNyeXB0by5nZXRSYW5kb21WYWx1ZXMpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignY3J5cHRvLmdldFJhbmRvbVZhbHVlcygpIG5vdCBzdXBwb3J0ZWQuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdXVpZGpzL3V1aWQjZ2V0cmFuZG9tdmFsdWVzLW5vdC1zdXBwb3J0ZWQnKTtcbiAgICAgICAgfVxuICAgICAgICBnZXRSYW5kb21WYWx1ZXMgPSBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzLmJpbmQoY3J5cHRvKTtcbiAgICB9XG4gICAgcmV0dXJuIGdldFJhbmRvbVZhbHVlcyhybmRzOCk7XG59XG4iLCJpbXBvcnQgdmFsaWRhdGUgZnJvbSAnLi92YWxpZGF0ZS5qcyc7XG5jb25zdCBieXRlVG9IZXggPSBbXTtcbmZvciAobGV0IGkgPSAwOyBpIDwgMjU2OyArK2kpIHtcbiAgICBieXRlVG9IZXgucHVzaCgoaSArIDB4MTAwKS50b1N0cmluZygxNikuc2xpY2UoMSkpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHVuc2FmZVN0cmluZ2lmeShhcnIsIG9mZnNldCA9IDApIHtcbiAgICByZXR1cm4gKGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMF1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxXV0gK1xuICAgICAgICBieXRlVG9IZXhbYXJyW29mZnNldCArIDJdXSArXG4gICAgICAgIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgM11dICtcbiAgICAgICAgJy0nICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA0XV0gK1xuICAgICAgICBieXRlVG9IZXhbYXJyW29mZnNldCArIDVdXSArXG4gICAgICAgICctJyArXG4gICAgICAgIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNl1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA3XV0gK1xuICAgICAgICAnLScgK1xuICAgICAgICBieXRlVG9IZXhbYXJyW29mZnNldCArIDhdXSArXG4gICAgICAgIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgOV1dICtcbiAgICAgICAgJy0nICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMF1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMV1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMl1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxM11dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNF1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNV1dKS50b0xvd2VyQ2FzZSgpO1xufVxuZnVuY3Rpb24gc3RyaW5naWZ5KGFyciwgb2Zmc2V0ID0gMCkge1xuICAgIGNvbnN0IHV1aWQgPSB1bnNhZmVTdHJpbmdpZnkoYXJyLCBvZmZzZXQpO1xuICAgIGlmICghdmFsaWRhdGUodXVpZCkpIHtcbiAgICAgICAgdGhyb3cgVHlwZUVycm9yKCdTdHJpbmdpZmllZCBVVUlEIGlzIGludmFsaWQnKTtcbiAgICB9XG4gICAgcmV0dXJuIHV1aWQ7XG59XG5leHBvcnQgZGVmYXVsdCBzdHJpbmdpZnk7XG4iLCJpbXBvcnQgcm5nIGZyb20gJy4vcm5nLmpzJztcbmltcG9ydCB7IHVuc2FmZVN0cmluZ2lmeSB9IGZyb20gJy4vc3RyaW5naWZ5LmpzJztcbmNvbnN0IF9zdGF0ZSA9IHt9O1xuZnVuY3Rpb24gdjcob3B0aW9ucywgYnVmLCBvZmZzZXQpIHtcbiAgICBsZXQgYnl0ZXM7XG4gICAgaWYgKG9wdGlvbnMpIHtcbiAgICAgICAgYnl0ZXMgPSB2N0J5dGVzKG9wdGlvbnMucmFuZG9tID8/IG9wdGlvbnMucm5nPy4oKSA/PyBybmcoKSwgb3B0aW9ucy5tc2Vjcywgb3B0aW9ucy5zZXEsIGJ1Ziwgb2Zmc2V0KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgICAgIGNvbnN0IHJuZHMgPSBybmcoKTtcbiAgICAgICAgdXBkYXRlVjdTdGF0ZShfc3RhdGUsIG5vdywgcm5kcyk7XG4gICAgICAgIGJ5dGVzID0gdjdCeXRlcyhybmRzLCBfc3RhdGUubXNlY3MsIF9zdGF0ZS5zZXEsIGJ1Ziwgb2Zmc2V0KTtcbiAgICB9XG4gICAgcmV0dXJuIGJ1ZiA/IGJ5dGVzIDogdW5zYWZlU3RyaW5naWZ5KGJ5dGVzKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVWN1N0YXRlKHN0YXRlLCBub3csIHJuZHMpIHtcbiAgICBzdGF0ZS5tc2VjcyA/Pz0gLUluZmluaXR5O1xuICAgIHN0YXRlLnNlcSA/Pz0gMDtcbiAgICBpZiAobm93ID4gc3RhdGUubXNlY3MpIHtcbiAgICAgICAgc3RhdGUuc2VxID0gKHJuZHNbNl0gPDwgMjMpIHwgKHJuZHNbN10gPDwgMTYpIHwgKHJuZHNbOF0gPDwgOCkgfCBybmRzWzldO1xuICAgICAgICBzdGF0ZS5tc2VjcyA9IG5vdztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHN0YXRlLnNlcSA9IChzdGF0ZS5zZXEgKyAxKSB8IDA7XG4gICAgICAgIGlmIChzdGF0ZS5zZXEgPT09IDApIHtcbiAgICAgICAgICAgIHN0YXRlLm1zZWNzKys7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHN0YXRlO1xufVxuZnVuY3Rpb24gdjdCeXRlcyhybmRzLCBtc2Vjcywgc2VxLCBidWYsIG9mZnNldCA9IDApIHtcbiAgICBpZiAocm5kcy5sZW5ndGggPCAxNikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JhbmRvbSBieXRlcyBsZW5ndGggbXVzdCBiZSA+PSAxNicpO1xuICAgIH1cbiAgICBpZiAoIWJ1Zikge1xuICAgICAgICBidWYgPSBuZXcgVWludDhBcnJheSgxNik7XG4gICAgICAgIG9mZnNldCA9IDA7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAob2Zmc2V0IDwgMCB8fCBvZmZzZXQgKyAxNiA+IGJ1Zi5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKGBVVUlEIGJ5dGUgcmFuZ2UgJHtvZmZzZXR9OiR7b2Zmc2V0ICsgMTV9IGlzIG91dCBvZiBidWZmZXIgYm91bmRzYCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbXNlY3MgPz89IERhdGUubm93KCk7XG4gICAgc2VxID8/PSAoKHJuZHNbNl0gKiAweDdmKSA8PCAyNCkgfCAocm5kc1s3XSA8PCAxNikgfCAocm5kc1s4XSA8PCA4KSB8IHJuZHNbOV07XG4gICAgYnVmW29mZnNldCsrXSA9IChtc2VjcyAvIDB4MTAwMDAwMDAwMDApICYgMHhmZjtcbiAgICBidWZbb2Zmc2V0KytdID0gKG1zZWNzIC8gMHgxMDAwMDAwMDApICYgMHhmZjtcbiAgICBidWZbb2Zmc2V0KytdID0gKG1zZWNzIC8gMHgxMDAwMDAwKSAmIDB4ZmY7XG4gICAgYnVmW29mZnNldCsrXSA9IChtc2VjcyAvIDB4MTAwMDApICYgMHhmZjtcbiAgICBidWZbb2Zmc2V0KytdID0gKG1zZWNzIC8gMHgxMDApICYgMHhmZjtcbiAgICBidWZbb2Zmc2V0KytdID0gbXNlY3MgJiAweGZmO1xuICAgIGJ1ZltvZmZzZXQrK10gPSAweDcwIHwgKChzZXEgPj4+IDI4KSAmIDB4MGYpO1xuICAgIGJ1ZltvZmZzZXQrK10gPSAoc2VxID4+PiAyMCkgJiAweGZmO1xuICAgIGJ1ZltvZmZzZXQrK10gPSAweDgwIHwgKChzZXEgPj4+IDE0KSAmIDB4M2YpO1xuICAgIGJ1ZltvZmZzZXQrK10gPSAoc2VxID4+PiA2KSAmIDB4ZmY7XG4gICAgYnVmW29mZnNldCsrXSA9ICgoc2VxIDw8IDIpICYgMHhmZikgfCAocm5kc1sxMF0gJiAweDAzKTtcbiAgICBidWZbb2Zmc2V0KytdID0gcm5kc1sxMV07XG4gICAgYnVmW29mZnNldCsrXSA9IHJuZHNbMTJdO1xuICAgIGJ1ZltvZmZzZXQrK10gPSBybmRzWzEzXTtcbiAgICBidWZbb2Zmc2V0KytdID0gcm5kc1sxNF07XG4gICAgYnVmW29mZnNldCsrXSA9IHJuZHNbMTVdO1xuICAgIHJldHVybiBidWY7XG59XG5leHBvcnQgZGVmYXVsdCB2NztcbiIsImltcG9ydCB7IENsaWVudEV2ZW50IH0gZnJvbSBcIi4vQ2xpZW50RXZlbnRcIjtcbmltcG9ydCB7IHY3IGFzIHV1aWR2NyB9IGZyb20gXCJ1dWlkXCI7XG5cbmV4cG9ydCBjb25zdCBlbnVtIEV2ZW50VHlwZSB7XG4gIFZpc2l0b3IgPSAxLFxuICBTZXNzaW9uID0gMixcbiAgU2VjdGlvbiA9IDMsXG4gIENsaWNrID0gNCxcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFdmVudFJlZmVyZW5jZSB7XG4gIHJlYWRvbmx5IGV2ZW50X3R5cGU6IEV2ZW50VHlwZTtcbiAgcmVhZG9ubHkgaWQ6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFdmVudCBleHRlbmRzIEV2ZW50UmVmZXJlbmNlIHtcbiAgdG9DbGllbnRFdmVudCgpOiBDbGllbnRFdmVudDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWaXNpdG9yRXZlbnQgZXh0ZW5kcyBFdmVudCB7XG4gIGV2ZW50X3R5cGU6IEV2ZW50VHlwZS5WaXNpdG9yO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZpc2l0b3JSZWZlcmVuY2UgZXh0ZW5kcyBFdmVudFJlZmVyZW5jZSB7XG4gIGV2ZW50X3R5cGU6IEV2ZW50VHlwZS5WaXNpdG9yO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNlc3Npb25FdmVudCBleHRlbmRzIEV2ZW50IHtcbiAgcGFyZW50OiBWaXNpdG9yUmVmZXJlbmNlO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNlc3Npb25SZWZlcmVuY2UgZXh0ZW5kcyBFdmVudFJlZmVyZW5jZSB7XG4gIGV2ZW50X3R5cGU6IEV2ZW50VHlwZS5TZXNzaW9uO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNlY3Rpb25FdmVudCBleHRlbmRzIEV2ZW50IHtcbiAgZXZlbnRfdHlwZTogRXZlbnRUeXBlLlNlY3Rpb247XG4gIHBhcmVudDogU2Vzc2lvblJlZmVyZW5jZTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZWN0aW9uUmVmZXJlbmNlIGV4dGVuZHMgRXZlbnRSZWZlcmVuY2Uge1xuICBldmVudF90eXBlOiBFdmVudFR5cGUuU2VjdGlvbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDbGlja0V2ZW50IGV4dGVuZHMgRXZlbnQge1xuICBldmVudF90eXBlOiBFdmVudFR5cGUuQ2xpY2s7XG4gIHBhcmVudDogU2VjdGlvblJlZmVyZW5jZTtcbn1cblxuZXhwb3J0IGNsYXNzIFZpc2l0b3IgaW1wbGVtZW50cyBWaXNpdG9yRXZlbnQsIFZpc2l0b3JSZWZlcmVuY2Uge1xuICByZWFkb25seSBldmVudF90eXBlOiBFdmVudFR5cGUuVmlzaXRvcjtcbiAgcmVhZG9ubHkgaWQ6IHN0cmluZztcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmV2ZW50X3R5cGUgPSBFdmVudFR5cGUuVmlzaXRvcjtcbiAgICB0aGlzLmlkID0gdXVpZHY3KCk7XG4gIH1cblxuICB0b0NsaWVudEV2ZW50KCk6IENsaWVudEV2ZW50IHtcbiAgICByZXR1cm4ge1xuICAgICAgdDogdGhpcy5ldmVudF90eXBlLFxuICAgICAgaTogdGhpcy5pZCxcbiAgICAgIGE6IHVuZGVmaW5lZCxcbiAgICB9O1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBTZXNzaW9uIGltcGxlbWVudHMgU2Vzc2lvbkV2ZW50LCBTZXNzaW9uUmVmZXJlbmNlIHtcbiAgcmVhZG9ubHkgZXZlbnRfdHlwZTogRXZlbnRUeXBlLlNlc3Npb247XG4gIHJlYWRvbmx5IGlkOiBzdHJpbmc7XG4gIHJlYWRvbmx5IHBhcmVudDogVmlzaXRvclJlZmVyZW5jZTtcblxuICBjb25zdHJ1Y3RvcihwYXJlbnQ6IFZpc2l0b3JSZWZlcmVuY2UpIHtcbiAgICB0aGlzLmV2ZW50X3R5cGUgPSBFdmVudFR5cGUuU2Vzc2lvbjtcbiAgICB0aGlzLmlkID0gdXVpZHY3KCk7XG4gICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gIH1cblxuICB0b0NsaWVudEV2ZW50KCk6IENsaWVudEV2ZW50IHtcbiAgICBjb25zdCBhdHRyczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHsgcGFyZW50OiB0aGlzLnBhcmVudC5pZCB9O1xuICAgIHJldHVybiB7XG4gICAgICB0OiB0aGlzLmV2ZW50X3R5cGUsXG4gICAgICBpOiB0aGlzLmlkLFxuICAgICAgYTogYXR0cnMsXG4gICAgfTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgU2VjdGlvbiBpbXBsZW1lbnRzIFNlY3Rpb25FdmVudCwgU2VjdGlvblJlZmVyZW5jZSB7XG4gIHJlYWRvbmx5IGV2ZW50X3R5cGU6IEV2ZW50VHlwZS5TZWN0aW9uO1xuICByZWFkb25seSBpZDogc3RyaW5nO1xuICByZWFkb25seSBwYXJlbnQ6IFNlc3Npb25SZWZlcmVuY2U7XG5cbiAgY29uc3RydWN0b3IocGFyZW50OiBTZXNzaW9uUmVmZXJlbmNlKSB7XG4gICAgdGhpcy5ldmVudF90eXBlID0gRXZlbnRUeXBlLlNlY3Rpb247XG4gICAgdGhpcy5pZCA9IHV1aWR2NygpO1xuICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICB9XG5cbiAgdG9DbGllbnRFdmVudCgpOiBDbGllbnRFdmVudCB7XG4gICAgY29uc3QgYXR0cnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7IHBhcmVudDogdGhpcy5wYXJlbnQuaWQgfTtcbiAgICByZXR1cm4ge1xuICAgICAgdDogdGhpcy5ldmVudF90eXBlLFxuICAgICAgaTogdGhpcy5pZCxcbiAgICAgIGE6IGF0dHJzLFxuICAgIH07XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIENsaWNrIGltcGxlbWVudHMgQ2xpY2tFdmVudCB7XG4gIHJlYWRvbmx5IGV2ZW50X3R5cGU6IEV2ZW50VHlwZS5DbGljaztcbiAgcmVhZG9ubHkgaWQ6IHN0cmluZztcbiAgcmVhZG9ubHkgcGFyZW50OiBTZWN0aW9uUmVmZXJlbmNlO1xuXG4gIGNvbnN0cnVjdG9yKHBhcmVudDogU2VjdGlvblJlZmVyZW5jZSkge1xuICAgIHRoaXMuZXZlbnRfdHlwZSA9IEV2ZW50VHlwZS5DbGljaztcbiAgICB0aGlzLmlkID0gdXVpZHY3KCk7XG4gICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gIH1cblxuICB0b0NsaWVudEV2ZW50KCk6IENsaWVudEV2ZW50IHtcbiAgICBjb25zdCBhdHRyczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHsgcGFyZW50OiB0aGlzLnBhcmVudC5pZCB9O1xuICAgIHJldHVybiB7XG4gICAgICB0OiB0aGlzLmV2ZW50X3R5cGUsXG4gICAgICBpOiB0aGlzLmlkLFxuICAgICAgYTogYXR0cnMsXG4gICAgfTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgVG9DbGllbnRFdmVudCB9IGZyb20gXCIuL0NsaWVudEV2ZW50XCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRXZlbnRQdWJsaXNoU3VjY2VzcyB7XG4gIGNvdW50OiBudW1iZXI7XG59XG5cbmV4cG9ydCBlbnVtIEV2ZW50UHVibGlzaEVycm9yIHtcbiAgQmFkUmVxdWVzdCxcbiAgSW50ZXJuYWxTZXJ2ZXJFcnJvcixcbiAgVGltZW91dCxcbn1cblxuZXhwb3J0IHR5cGUgRXZlbnRQdWJsaXNoUmVzdWx0ID0gRXZlbnRQdWJsaXNoU3VjY2VzcyB8IEV2ZW50UHVibGlzaEVycm9yO1xuXG5leHBvcnQgaW50ZXJmYWNlIEV2ZW50UHVibGlzaGVyIHtcbiAgcHVibGlzaChldmVudHM6IFRvQ2xpZW50RXZlbnRbXSk6IFByb21pc2U8RXZlbnRQdWJsaXNoUmVzdWx0Pjtcbn1cbiIsImltcG9ydCB7IENsaWNrLCBTZWN0aW9uLCBTZXNzaW9uLCBWaXNpdG9yIH0gZnJvbSBcIi4vRXZlbnRzXCI7XG5pbXBvcnQgeyBIdHRwRXZlbnRQdWJsaXNoZXIgfSBmcm9tIFwiLi9IdHRwRXZlbnRQdWJsaXNoZXJcIjtcblxubGV0IHZpc2l0b3IgPSBuZXcgVmlzaXRvcigpO1xubGV0IHNlc3Npb24gPSBuZXcgU2Vzc2lvbih2aXNpdG9yKTtcbmxldCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oc2Vzc2lvbik7XG5sZXQgY2xpY2sgPSBuZXcgQ2xpY2soc2VjdGlvbik7XG5cbmxldCBwdWJsaXNoZXIgPSBuZXcgSHR0cEV2ZW50UHVibGlzaGVyKFwiYWJjLXh5elwiLCBcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMFwiKTtcblxucHVibGlzaGVyLnB1Ymxpc2goW3Zpc2l0b3IsIHNlc3Npb24sIHNlY3Rpb24sIGNsaWNrXSk7XG4iLCJpbXBvcnQgeyBUb0NsaWVudEV2ZW50IH0gZnJvbSBcIi4vQ2xpZW50RXZlbnRcIjtcbmltcG9ydCB7IEV2ZW50UHVibGlzaGVyLCBFdmVudFB1Ymxpc2hFcnJvciwgRXZlbnRQdWJsaXNoUmVzdWx0IH0gZnJvbSBcIi4vRXZlbnRQdWJsaXNoZXJcIjtcblxuZXhwb3J0IGNsYXNzIEh0dHBFdmVudFB1Ymxpc2hlciBpbXBsZW1lbnRzIEV2ZW50UHVibGlzaGVyIHtcbiAgcHJpdmF0ZSBhcGlfa2V5OiBzdHJpbmc7XG4gIHByaXZhdGUgZW5kcG9pbnQ6IHN0cmluZztcblxuICBjb25zdHJ1Y3RvcihhcGlfa2V5OiBzdHJpbmcsIGhvc3Q6IHN0cmluZykge1xuICAgIHRoaXMuYXBpX2tleSA9IGFwaV9rZXk7XG4gICAgdGhpcy5lbmRwb2ludCA9IGhvc3QgKyAnL211bHRpJztcbiAgfVxuXG4gIGFzeW5jIHB1Ymxpc2goZXZlbnRzOiBUb0NsaWVudEV2ZW50W10pOiBQcm9taXNlPEV2ZW50UHVibGlzaFJlc3VsdD4ge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godGhpcy5jcmVhdGVSZXF1ZXN0KGV2ZW50cykpO1xuICAgIFxuICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgcmV0dXJuIHsgY291bnQ6IGV2ZW50cy5sZW5ndGggfTtcbiAgICB9XG4gICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSA1MDApIHtcbiAgICAgIHJldHVybiBFdmVudFB1Ymxpc2hFcnJvci5JbnRlcm5hbFNlcnZlckVycm9yO1xuICAgIH1cbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IDQwMCkge1xuICAgICAgcmV0dXJuIEV2ZW50UHVibGlzaEVycm9yLkJhZFJlcXVlc3Q7XG4gICAgfVxuICAgIHJldHVybiBFdmVudFB1Ymxpc2hFcnJvci5UaW1lb3V0O1xuICB9XG5cbiAgcHJpdmF0ZSBjcmVhdGVSZXF1ZXN0KGV2ZW50czogVG9DbGllbnRFdmVudFtdKTogUmVxdWVzdCB7XG4gICAgcmV0dXJuIG5ldyBSZXF1ZXN0KHRoaXMuZW5kcG9pbnQsIHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgbW9kZTogJ2NvcnMnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBcImNvbnRlbnQtdHlwZVwiOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIFwiYXBpLWtleVwiOiB0aGlzLmFwaV9rZXksXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZXZlbnRzLm1hcChlID0+IGUudG9DbGllbnRFdmVudCgpKSksXG4gICAgfSk7XG4gIH1cblxufSJdLCJuYW1lcyI6WyJnZXRSYW5kb21WYWx1ZXMiLCJybmRzOCIsIlVpbnQ4QXJyYXkiLCJybmciLCJjcnlwdG8iLCJFcnJvciIsImJpbmQiLCJieXRlVG9IZXgiLCJpIiwicHVzaCIsInRvU3RyaW5nIiwic2xpY2UiLCJfc3RhdGUiLCJ2N0J5dGVzIiwicm5kcyIsIm1zZWNzIiwic2VxIiwiYnVmIiwib2Zmc2V0IiwibGVuZ3RoIiwiUmFuZ2VFcnJvciIsIkRhdGUiLCJub3ciLCJvcHRpb25zIiwiYnl0ZXMiLCJyYW5kb20iLCJzdGF0ZSIsInVwZGF0ZVY3U3RhdGUiLCJhcnIiLCJ0b0xvd2VyQ2FzZSIsInVuc2FmZVN0cmluZ2lmeSIsIkV2ZW50VHlwZSIsIkV2ZW50UHVibGlzaEVycm9yIiwidmlzaXRvciIsImNvbnN0cnVjdG9yIiwidGhpcyIsImV2ZW50X3R5cGUiLCJWaXNpdG9yIiwiaWQiLCJ0b0NsaWVudEV2ZW50IiwidCIsImEiLCJ1bmRlZmluZWQiLCJzZXNzaW9uIiwicGFyZW50IiwiU2Vzc2lvbiIsImF0dHJzIiwic2VjdGlvbiIsIlNlY3Rpb24iLCJjbGljayIsIkNsaWNrIiwiYXBpX2tleSIsImhvc3QiLCJlbmRwb2ludCIsInB1Ymxpc2giLCJldmVudHMiLCJyZXNwb25zZSIsImZldGNoIiwiY3JlYXRlUmVxdWVzdCIsIm9rIiwiY291bnQiLCJzdGF0dXMiLCJJbnRlcm5hbFNlcnZlckVycm9yIiwiQmFkUmVxdWVzdCIsIlRpbWVvdXQiLCJSZXF1ZXN0IiwibWV0aG9kIiwibW9kZSIsImhlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsIm1hcCIsImUiXSwic291cmNlUm9vdCI6IiJ9