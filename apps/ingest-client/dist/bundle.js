(()=>{"use strict";var t;let e;!function(t){t[t.Visitor=1]="Visitor",t[t.Session=2]="Session",t[t.Section=3]="Section",t[t.Click=4]="Click"}(t||(t={}));const n=new Uint8Array(16);function s(){if(!e){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");e=crypto.getRandomValues.bind(crypto)}return e(n)}const i=[];for(let t=0;t<256;++t)i.push((t+256).toString(16).slice(1));const r={};function o(t,e,n,s,i=0){if(t.length<16)throw new Error("Random bytes length must be >= 16");if(s){if(i<0||i+16>s.length)throw new RangeError(`UUID byte range ${i}:${i+15} is out of buffer bounds`)}else s=new Uint8Array(16),i=0;return e??=Date.now(),n??=127*t[6]<<24|t[7]<<16|t[8]<<8|t[9],s[i++]=e/1099511627776&255,s[i++]=e/4294967296&255,s[i++]=e/16777216&255,s[i++]=e/65536&255,s[i++]=e/256&255,s[i++]=255&e,s[i++]=112|n>>>28&15,s[i++]=n>>>20&255,s[i++]=128|n>>>14&63,s[i++]=n>>>6&255,s[i++]=n<<2&255|3&t[10],s[i++]=t[11],s[i++]=t[12],s[i++]=t[13],s[i++]=t[14],s[i++]=t[15],s}const c=function(t,e,n){let c;if(t)c=o(t.random??t.rng?.()??s(),t.msecs,t.seq,e,n);else{const t=Date.now(),i=s();!function(t,e,n){t.msecs??=-1/0,t.seq??=0,e>t.msecs?(t.seq=n[6]<<23|n[7]<<16|n[8]<<8|n[9],t.msecs=e):(t.seq=t.seq+1|0,0===t.seq&&t.msecs++)}(r,t,i),c=o(i,r.msecs,r.seq,e,n)}return e?c:function(t,e=0){return(i[t[e+0]]+i[t[e+1]]+i[t[e+2]]+i[t[e+3]]+"-"+i[t[e+4]]+i[t[e+5]]+"-"+i[t[e+6]]+i[t[e+7]]+"-"+i[t[e+8]]+i[t[e+9]]+"-"+i[t[e+10]]+i[t[e+11]]+i[t[e+12]]+i[t[e+13]]+i[t[e+14]]+i[t[e+15]]).toLowerCase()}(c)};var a;!function(t){t[t.BadRequest=0]="BadRequest",t[t.InternalServerError=1]="InternalServerError",t[t.Timeout=2]="Timeout"}(a||(a={}));let u=new class{constructor(){this.event_type=t.Visitor,this.id=c()}toClientEvent(){return{t:this.event_type,i:this.id,a:void 0}}},h=new class{constructor(e){this.event_type=t.Session,this.id=c(),this.parent=e}toClientEvent(){const t={parent:this.parent.id};return{t:this.event_type,i:this.id,a:t}}}(u),p=new class{constructor(e){this.event_type=t.Section,this.id=c(),this.parent=e}toClientEvent(){const t={parent:this.parent.id};return{t:this.event_type,i:this.id,a:t}}}(h),l=new class{constructor(e){this.event_type=t.Click,this.id=c(),this.parent=e}toClientEvent(){const t={parent:this.parent.id};return{t:this.event_type,i:this.id,a:t}}}(p);new class{constructor(t,e){this.api_key=t,this.endpoint=e+"/multi"}publish(t){return e=this,n=void 0,i=function*(){const e=yield fetch(this.createRequest(t));return e.ok?{count:t.length}:500==e.status?a.InternalServerError:400==e.status?a.BadRequest:a.Timeout},new((s=void 0)||(s=Promise))((function(t,r){function o(t){try{a(i.next(t))}catch(t){r(t)}}function c(t){try{a(i.throw(t))}catch(t){r(t)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof s?n:new s((function(t){t(n)}))).then(o,c)}a((i=i.apply(e,n||[])).next())}));var e,n,s,i}createRequest(t){return new Request(this.endpoint,{method:"POST",mode:"cors",headers:{"content-type":"application/json","api-key":this.api_key},body:JSON.stringify(t.map((t=>t.toClientEvent())))})}}("abc-xyz","http://localhost:3000").publish([u,h,p,l])})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxlLmpzIiwibWFwcGluZ3MiOiJtQkFBQSxJQUFrQkEsRUNBbEIsSUFBSUMsR0RBSixTQUFrQkQsR0FDaEIseUJBQ0EseUJBQ0EseUJBQ0Esb0JBQ0QsQ0FMRCxDQUFrQkEsSUFBQUEsRUFBUyxLQ0MzQixNQUFNRSxFQUFRLElBQUlDLFdBQVcsSUFDZCxTQUFTQyxJQUNwQixJQUFLSCxFQUFpQixDQUNsQixHQUFzQixvQkFBWEksU0FBMkJBLE9BQU9KLGdCQUN6QyxNQUFNLElBQUlLLE1BQU0sNEdBRXBCTCxFQUFrQkksT0FBT0osZ0JBQWdCTSxLQUFLRixPQUNsRCxDQUNBLE9BQU9KLEVBQWdCQyxFQUMzQixDQ1RBLE1BQU1NLEVBQVksR0FDbEIsSUFBSyxJQUFJQyxFQUFJLEVBQUdBLEVBQUksTUFBT0EsRUFDdkJELEVBQVVFLE1BQU1ELEVBQUksS0FBT0UsU0FBUyxJQUFJQyxNQUFNLElBK0JsRCxNQ2hDTUMsRUFBUyxDQUFDLEVBNkJoQixTQUFTQyxFQUFRQyxFQUFNQyxFQUFPQyxFQUFLQyxFQUFLQyxFQUFTLEdBQzdDLEdBQUlKLEVBQUtLLE9BQVMsR0FDZCxNQUFNLElBQUlkLE1BQU0scUNBRXBCLEdBQUtZLEdBS0QsR0FBSUMsRUFBUyxHQUFLQSxFQUFTLEdBQUtELEVBQUlFLE9BQ2hDLE1BQU0sSUFBSUMsV0FBVyxtQkFBbUJGLEtBQVVBLEVBQVMsbUNBTC9ERCxFQUFNLElBQUlmLFdBQVcsSUFDckJnQixFQUFTLEVBeUJiLE9BbEJBSCxJQUFVTSxLQUFLQyxNQUNmTixJQUFvQixJQUFWRixFQUFLLElBQWMsR0FBT0EsRUFBSyxJQUFNLEdBQU9BLEVBQUssSUFBTSxFQUFLQSxFQUFLLEdBQzNFRyxFQUFJQyxLQUFhSCxFQUFRLGNBQWlCLElBQzFDRSxFQUFJQyxLQUFhSCxFQUFRLFdBQWUsSUFDeENFLEVBQUlDLEtBQWFILEVBQVEsU0FBYSxJQUN0Q0UsRUFBSUMsS0FBYUgsRUFBUSxNQUFXLElBQ3BDRSxFQUFJQyxLQUFhSCxFQUFRLElBQVMsSUFDbENFLEVBQUlDLEtBQW9CLElBQVJILEVBQ2hCRSxFQUFJQyxLQUFZLElBQVNGLElBQVEsR0FBTSxHQUN2Q0MsRUFBSUMsS0FBYUYsSUFBUSxHQUFNLElBQy9CQyxFQUFJQyxLQUFZLElBQVNGLElBQVEsR0FBTSxHQUN2Q0MsRUFBSUMsS0FBYUYsSUFBUSxFQUFLLElBQzlCQyxFQUFJQyxLQUFjRixHQUFPLEVBQUssSUFBb0IsRUFBWEYsRUFBSyxJQUM1Q0csRUFBSUMsS0FBWUosRUFBSyxJQUNyQkcsRUFBSUMsS0FBWUosRUFBSyxJQUNyQkcsRUFBSUMsS0FBWUosRUFBSyxJQUNyQkcsRUFBSUMsS0FBWUosRUFBSyxJQUNyQkcsRUFBSUMsS0FBWUosRUFBSyxJQUNkRyxDQUNYLENBQ0EsUUE3REEsU0FBWU0sRUFBU04sRUFBS0MsR0FDdEIsSUFBSU0sRUFDSixHQUFJRCxFQUNBQyxFQUFRWCxFQUFRVSxFQUFRRSxRQUFVRixFQUFRcEIsU0FBV0EsSUFBT29CLEVBQVFSLE1BQU9RLEVBQVFQLElBQUtDLEVBQUtDLE9BRTVGLENBQ0QsTUFBTUksRUFBTUQsS0FBS0MsTUFDWFIsRUFBT1gsS0FNZCxTQUF1QnVCLEVBQU9KLEVBQUtSLEdBQ3RDWSxFQUFNWCxTQUFVLElBQ2hCVyxFQUFNVixNQUFRLEVBQ1ZNLEVBQU1JLEVBQU1YLE9BQ1pXLEVBQU1WLElBQU9GLEVBQUssSUFBTSxHQUFPQSxFQUFLLElBQU0sR0FBT0EsRUFBSyxJQUFNLEVBQUtBLEVBQUssR0FDdEVZLEVBQU1YLE1BQVFPLElBR2RJLEVBQU1WLElBQU9VLEVBQU1WLElBQU0sRUFBSyxFQUNaLElBQWRVLEVBQU1WLEtBQ05VLEVBQU1YLFFBSWxCLENBbkJRWSxDQUFjZixFQUFRVSxFQUFLUixHQUMzQlUsRUFBUVgsRUFBUUMsRUFBTUYsRUFBT0csTUFBT0gsRUFBT0ksSUFBS0MsRUFBS0MsRUFDekQsQ0FDQSxPQUFPRCxFQUFNTyxFRFRWLFNBQXlCSSxFQUFLVixFQUFTLEdBQzFDLE9BQVFYLEVBQVVxQixFQUFJVixFQUFTLElBQzNCWCxFQUFVcUIsRUFBSVYsRUFBUyxJQUN2QlgsRUFBVXFCLEVBQUlWLEVBQVMsSUFDdkJYLEVBQVVxQixFQUFJVixFQUFTLElBQ3ZCLElBQ0FYLEVBQVVxQixFQUFJVixFQUFTLElBQ3ZCWCxFQUFVcUIsRUFBSVYsRUFBUyxJQUN2QixJQUNBWCxFQUFVcUIsRUFBSVYsRUFBUyxJQUN2QlgsRUFBVXFCLEVBQUlWLEVBQVMsSUFDdkIsSUFDQVgsRUFBVXFCLEVBQUlWLEVBQVMsSUFDdkJYLEVBQVVxQixFQUFJVixFQUFTLElBQ3ZCLElBQ0FYLEVBQVVxQixFQUFJVixFQUFTLEtBQ3ZCWCxFQUFVcUIsRUFBSVYsRUFBUyxLQUN2QlgsRUFBVXFCLEVBQUlWLEVBQVMsS0FDdkJYLEVBQVVxQixFQUFJVixFQUFTLEtBQ3ZCWCxFQUFVcUIsRUFBSVYsRUFBUyxLQUN2QlgsRUFBVXFCLEVBQUlWLEVBQVMsTUFBTVcsYUFDckMsQ0NaeUJDLENBQWdCTixFQUN6QyxFQ1RBLElBQVlPLEdBQVosU0FBWUEsR0FDViwrQkFDQSxpREFDQSx3QkFDRCxDQUpELENBQVlBLElBQUFBLEVBQWlCLEtDSDdCLElBQUlDLEVBQVUsSUN1Q1AsTUFJTCxXQUFBQyxHQUNFQyxLQUFLQyxXQUFhcEMsRUFBVXFDLFFBQzVCRixLQUFLRyxHQUFLLEdBQ1osQ0FFQSxhQUFBQyxHQUNFLE1BQU8sQ0FDTEMsRUFBR0wsS0FBS0MsV0FDUjNCLEVBQUcwQixLQUFLRyxHQUNSRyxPQUFHQyxFQUVQLEdEckRFQyxFQUFVLElDd0RQLE1BS0wsV0FBQVQsQ0FBWVUsR0FDVlQsS0FBS0MsV0FBYXBDLEVBQVU2QyxRQUM1QlYsS0FBS0csR0FBSyxJQUNWSCxLQUFLUyxPQUFTQSxDQUNoQixDQUVBLGFBQUFMLEdBQ0UsTUFBTU8sRUFBZ0MsQ0FBRUYsT0FBUVQsS0FBS1MsT0FBT04sSUFDNUQsTUFBTyxDQUNMRSxFQUFHTCxLQUFLQyxXQUNSM0IsRUFBRzBCLEtBQUtHLEdBQ1JHLEVBQUdLLEVBRVAsR0QxRXdCYixHQUN0QmMsRUFBVSxJQzRFUCxNQUtMLFdBQUFiLENBQVlVLEdBQ1ZULEtBQUtDLFdBQWFwQyxFQUFVZ0QsUUFDNUJiLEtBQUtHLEdBQUssSUFDVkgsS0FBS1MsT0FBU0EsQ0FDaEIsQ0FFQSxhQUFBTCxHQUNFLE1BQU1PLEVBQWdDLENBQUVGLE9BQVFULEtBQUtTLE9BQU9OLElBQzVELE1BQU8sQ0FDTEUsRUFBR0wsS0FBS0MsV0FDUjNCLEVBQUcwQixLQUFLRyxHQUNSRyxFQUFHSyxFQUVQLEdEOUZ3QkgsR0FDdEJNLEVBQVEsSUNnR0wsTUFLTCxXQUFBZixDQUFZVSxHQUNWVCxLQUFLQyxXQUFhcEMsRUFBVWtELE1BQzVCZixLQUFLRyxHQUFLLElBQ1ZILEtBQUtTLE9BQVNBLENBQ2hCLENBRUEsYUFBQUwsR0FDRSxNQUFNTyxFQUFnQyxDQUFFRixPQUFRVCxLQUFLUyxPQUFPTixJQUM1RCxNQUFPLENBQ0xFLEVBQUdMLEtBQUtDLFdBQ1IzQixFQUFHMEIsS0FBS0csR0FDUkcsRUFBR0ssRUFFUCxHRGxIb0JDLEdBRU4sSUVMVCxNQUlMLFdBQUFiLENBQVlpQixFQUFpQkMsR0FDM0JqQixLQUFLZ0IsUUFBVUEsRUFDZmhCLEtBQUtrQixTQUFXRCxFQUFPLFFBQ3pCLENBRU0sT0FBQUUsQ0FBUUMsRyxxQ0FDWixNQUFNQyxRQUFpQkMsTUFBTXRCLEtBQUt1QixjQUFjSCxJQUVoRCxPQUFJQyxFQUFTRyxHQUNKLENBQUVDLE1BQU9MLEVBQU9uQyxRQUVGLEtBQW5Cb0MsRUFBU0ssT0FDSjdCLEVBQWtCOEIsb0JBRUosS0FBbkJOLEVBQVNLLE9BQ0o3QixFQUFrQitCLFdBRXBCL0IsRUFBa0JnQyxPQUMzQixFLCtSQUVRLGFBQUFOLENBQWNILEdBQ3BCLE9BQU8sSUFBSVUsUUFBUTlCLEtBQUtrQixTQUFVLENBQ2hDYSxPQUFRLE9BQ1JDLEtBQU0sT0FDTkMsUUFBUyxDQUNQLGVBQWdCLG1CQUNoQixVQUFXakMsS0FBS2dCLFNBRWxCa0IsS0FBTUMsS0FBS0MsVUFBVWhCLEVBQU9pQixLQUFJQyxHQUFLQSxFQUFFbEMsb0JBRTNDLEdGN0JxQyxVQUFXLHlCQUV4Q2UsUUFBUSxDQUFDckIsRUFBU1UsRUFBU0ksRUFBU0UsRyIsInNvdXJjZXMiOlsid2VicGFjazovL2luZ2VzdC1jbGllbnQvLi9zcmMvQ2xpZW50RXZlbnQudHMiLCJ3ZWJwYWNrOi8vaW5nZXN0LWNsaWVudC8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvcm5nLmpzIiwid2VicGFjazovL2luZ2VzdC1jbGllbnQvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3N0cmluZ2lmeS5qcyIsIndlYnBhY2s6Ly9pbmdlc3QtY2xpZW50Ly4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92Ny5qcyIsIndlYnBhY2s6Ly9pbmdlc3QtY2xpZW50Ly4vc3JjL0V2ZW50UHVibGlzaGVyLnRzIiwid2VicGFjazovL2luZ2VzdC1jbGllbnQvLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vaW5nZXN0LWNsaWVudC8uL3NyYy9FdmVudHMudHMiLCJ3ZWJwYWNrOi8vaW5nZXN0LWNsaWVudC8uL3NyYy9IdHRwRXZlbnRQdWJsaXNoZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGVudW0gRXZlbnRUeXBlIHtcbiAgVmlzaXRvciA9IDEsXG4gIFNlc3Npb24gPSAyLFxuICBTZWN0aW9uID0gMyxcbiAgQ2xpY2sgPSA0XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2xpZW50RXZlbnQge1xuICB0OiBFdmVudFR5cGU7XG4gIGk6IHN0cmluZztcbiAgYTogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB8IHVuZGVmaW5lZDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUb0NsaWVudEV2ZW50IHtcbiAgdG9DbGllbnRFdmVudCgpOiBDbGllbnRFdmVudDtcbn1cbiIsImxldCBnZXRSYW5kb21WYWx1ZXM7XG5jb25zdCBybmRzOCA9IG5ldyBVaW50OEFycmF5KDE2KTtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHJuZygpIHtcbiAgICBpZiAoIWdldFJhbmRvbVZhbHVlcykge1xuICAgICAgICBpZiAodHlwZW9mIGNyeXB0byA9PT0gJ3VuZGVmaW5lZCcgfHwgIWNyeXB0by5nZXRSYW5kb21WYWx1ZXMpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignY3J5cHRvLmdldFJhbmRvbVZhbHVlcygpIG5vdCBzdXBwb3J0ZWQuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdXVpZGpzL3V1aWQjZ2V0cmFuZG9tdmFsdWVzLW5vdC1zdXBwb3J0ZWQnKTtcbiAgICAgICAgfVxuICAgICAgICBnZXRSYW5kb21WYWx1ZXMgPSBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzLmJpbmQoY3J5cHRvKTtcbiAgICB9XG4gICAgcmV0dXJuIGdldFJhbmRvbVZhbHVlcyhybmRzOCk7XG59XG4iLCJpbXBvcnQgdmFsaWRhdGUgZnJvbSAnLi92YWxpZGF0ZS5qcyc7XG5jb25zdCBieXRlVG9IZXggPSBbXTtcbmZvciAobGV0IGkgPSAwOyBpIDwgMjU2OyArK2kpIHtcbiAgICBieXRlVG9IZXgucHVzaCgoaSArIDB4MTAwKS50b1N0cmluZygxNikuc2xpY2UoMSkpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHVuc2FmZVN0cmluZ2lmeShhcnIsIG9mZnNldCA9IDApIHtcbiAgICByZXR1cm4gKGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMF1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxXV0gK1xuICAgICAgICBieXRlVG9IZXhbYXJyW29mZnNldCArIDJdXSArXG4gICAgICAgIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgM11dICtcbiAgICAgICAgJy0nICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA0XV0gK1xuICAgICAgICBieXRlVG9IZXhbYXJyW29mZnNldCArIDVdXSArXG4gICAgICAgICctJyArXG4gICAgICAgIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNl1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA3XV0gK1xuICAgICAgICAnLScgK1xuICAgICAgICBieXRlVG9IZXhbYXJyW29mZnNldCArIDhdXSArXG4gICAgICAgIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgOV1dICtcbiAgICAgICAgJy0nICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMF1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMV1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMl1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxM11dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNF1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNV1dKS50b0xvd2VyQ2FzZSgpO1xufVxuZnVuY3Rpb24gc3RyaW5naWZ5KGFyciwgb2Zmc2V0ID0gMCkge1xuICAgIGNvbnN0IHV1aWQgPSB1bnNhZmVTdHJpbmdpZnkoYXJyLCBvZmZzZXQpO1xuICAgIGlmICghdmFsaWRhdGUodXVpZCkpIHtcbiAgICAgICAgdGhyb3cgVHlwZUVycm9yKCdTdHJpbmdpZmllZCBVVUlEIGlzIGludmFsaWQnKTtcbiAgICB9XG4gICAgcmV0dXJuIHV1aWQ7XG59XG5leHBvcnQgZGVmYXVsdCBzdHJpbmdpZnk7XG4iLCJpbXBvcnQgcm5nIGZyb20gJy4vcm5nLmpzJztcbmltcG9ydCB7IHVuc2FmZVN0cmluZ2lmeSB9IGZyb20gJy4vc3RyaW5naWZ5LmpzJztcbmNvbnN0IF9zdGF0ZSA9IHt9O1xuZnVuY3Rpb24gdjcob3B0aW9ucywgYnVmLCBvZmZzZXQpIHtcbiAgICBsZXQgYnl0ZXM7XG4gICAgaWYgKG9wdGlvbnMpIHtcbiAgICAgICAgYnl0ZXMgPSB2N0J5dGVzKG9wdGlvbnMucmFuZG9tID8/IG9wdGlvbnMucm5nPy4oKSA/PyBybmcoKSwgb3B0aW9ucy5tc2Vjcywgb3B0aW9ucy5zZXEsIGJ1Ziwgb2Zmc2V0KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgICAgIGNvbnN0IHJuZHMgPSBybmcoKTtcbiAgICAgICAgdXBkYXRlVjdTdGF0ZShfc3RhdGUsIG5vdywgcm5kcyk7XG4gICAgICAgIGJ5dGVzID0gdjdCeXRlcyhybmRzLCBfc3RhdGUubXNlY3MsIF9zdGF0ZS5zZXEsIGJ1Ziwgb2Zmc2V0KTtcbiAgICB9XG4gICAgcmV0dXJuIGJ1ZiA/IGJ5dGVzIDogdW5zYWZlU3RyaW5naWZ5KGJ5dGVzKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVWN1N0YXRlKHN0YXRlLCBub3csIHJuZHMpIHtcbiAgICBzdGF0ZS5tc2VjcyA/Pz0gLUluZmluaXR5O1xuICAgIHN0YXRlLnNlcSA/Pz0gMDtcbiAgICBpZiAobm93ID4gc3RhdGUubXNlY3MpIHtcbiAgICAgICAgc3RhdGUuc2VxID0gKHJuZHNbNl0gPDwgMjMpIHwgKHJuZHNbN10gPDwgMTYpIHwgKHJuZHNbOF0gPDwgOCkgfCBybmRzWzldO1xuICAgICAgICBzdGF0ZS5tc2VjcyA9IG5vdztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHN0YXRlLnNlcSA9IChzdGF0ZS5zZXEgKyAxKSB8IDA7XG4gICAgICAgIGlmIChzdGF0ZS5zZXEgPT09IDApIHtcbiAgICAgICAgICAgIHN0YXRlLm1zZWNzKys7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHN0YXRlO1xufVxuZnVuY3Rpb24gdjdCeXRlcyhybmRzLCBtc2Vjcywgc2VxLCBidWYsIG9mZnNldCA9IDApIHtcbiAgICBpZiAocm5kcy5sZW5ndGggPCAxNikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JhbmRvbSBieXRlcyBsZW5ndGggbXVzdCBiZSA+PSAxNicpO1xuICAgIH1cbiAgICBpZiAoIWJ1Zikge1xuICAgICAgICBidWYgPSBuZXcgVWludDhBcnJheSgxNik7XG4gICAgICAgIG9mZnNldCA9IDA7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAob2Zmc2V0IDwgMCB8fCBvZmZzZXQgKyAxNiA+IGJ1Zi5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKGBVVUlEIGJ5dGUgcmFuZ2UgJHtvZmZzZXR9OiR7b2Zmc2V0ICsgMTV9IGlzIG91dCBvZiBidWZmZXIgYm91bmRzYCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbXNlY3MgPz89IERhdGUubm93KCk7XG4gICAgc2VxID8/PSAoKHJuZHNbNl0gKiAweDdmKSA8PCAyNCkgfCAocm5kc1s3XSA8PCAxNikgfCAocm5kc1s4XSA8PCA4KSB8IHJuZHNbOV07XG4gICAgYnVmW29mZnNldCsrXSA9IChtc2VjcyAvIDB4MTAwMDAwMDAwMDApICYgMHhmZjtcbiAgICBidWZbb2Zmc2V0KytdID0gKG1zZWNzIC8gMHgxMDAwMDAwMDApICYgMHhmZjtcbiAgICBidWZbb2Zmc2V0KytdID0gKG1zZWNzIC8gMHgxMDAwMDAwKSAmIDB4ZmY7XG4gICAgYnVmW29mZnNldCsrXSA9IChtc2VjcyAvIDB4MTAwMDApICYgMHhmZjtcbiAgICBidWZbb2Zmc2V0KytdID0gKG1zZWNzIC8gMHgxMDApICYgMHhmZjtcbiAgICBidWZbb2Zmc2V0KytdID0gbXNlY3MgJiAweGZmO1xuICAgIGJ1ZltvZmZzZXQrK10gPSAweDcwIHwgKChzZXEgPj4+IDI4KSAmIDB4MGYpO1xuICAgIGJ1ZltvZmZzZXQrK10gPSAoc2VxID4+PiAyMCkgJiAweGZmO1xuICAgIGJ1ZltvZmZzZXQrK10gPSAweDgwIHwgKChzZXEgPj4+IDE0KSAmIDB4M2YpO1xuICAgIGJ1ZltvZmZzZXQrK10gPSAoc2VxID4+PiA2KSAmIDB4ZmY7XG4gICAgYnVmW29mZnNldCsrXSA9ICgoc2VxIDw8IDIpICYgMHhmZikgfCAocm5kc1sxMF0gJiAweDAzKTtcbiAgICBidWZbb2Zmc2V0KytdID0gcm5kc1sxMV07XG4gICAgYnVmW29mZnNldCsrXSA9IHJuZHNbMTJdO1xuICAgIGJ1ZltvZmZzZXQrK10gPSBybmRzWzEzXTtcbiAgICBidWZbb2Zmc2V0KytdID0gcm5kc1sxNF07XG4gICAgYnVmW29mZnNldCsrXSA9IHJuZHNbMTVdO1xuICAgIHJldHVybiBidWY7XG59XG5leHBvcnQgZGVmYXVsdCB2NztcbiIsImltcG9ydCB7IFRvQ2xpZW50RXZlbnQgfSBmcm9tIFwiLi9DbGllbnRFdmVudFwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIEV2ZW50UHVibGlzaFN1Y2Nlc3Mge1xuICBjb3VudDogbnVtYmVyO1xufVxuXG5leHBvcnQgZW51bSBFdmVudFB1Ymxpc2hFcnJvciB7XG4gIEJhZFJlcXVlc3QsXG4gIEludGVybmFsU2VydmVyRXJyb3IsXG4gIFRpbWVvdXQsXG59XG5cbmV4cG9ydCB0eXBlIEV2ZW50UHVibGlzaFJlc3VsdCA9IEV2ZW50UHVibGlzaFN1Y2Nlc3MgfCBFdmVudFB1Ymxpc2hFcnJvcjtcblxuZXhwb3J0IGludGVyZmFjZSBFdmVudFB1Ymxpc2hlciB7XG4gIHB1Ymxpc2goZXZlbnRzOiBUb0NsaWVudEV2ZW50W10pOiBQcm9taXNlPEV2ZW50UHVibGlzaFJlc3VsdD47XG59XG4iLCJpbXBvcnQgeyBDbGljaywgU2VjdGlvbiwgU2Vzc2lvbiwgVmlzaXRvciB9IGZyb20gJy4vRXZlbnRzJztcbmltcG9ydCB7IEh0dHBFdmVudFB1Ymxpc2hlciB9IGZyb20gJy4vSHR0cEV2ZW50UHVibGlzaGVyJztcblxubGV0IHZpc2l0b3IgPSBuZXcgVmlzaXRvcigpO1xubGV0IHNlc3Npb24gPSBuZXcgU2Vzc2lvbih2aXNpdG9yKTtcbmxldCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oc2Vzc2lvbik7XG5sZXQgY2xpY2sgPSBuZXcgQ2xpY2soc2VjdGlvbik7XG5cbmxldCBwdWJsaXNoZXIgPSBuZXcgSHR0cEV2ZW50UHVibGlzaGVyKCdhYmMteHl6JywgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCcpO1xuXG5wdWJsaXNoZXIucHVibGlzaChbdmlzaXRvciwgc2Vzc2lvbiwgc2VjdGlvbiwgY2xpY2tdKTtcbiIsImltcG9ydCB7IENsaWVudEV2ZW50LCBFdmVudFR5cGUgfSBmcm9tIFwiLi9DbGllbnRFdmVudFwiO1xuaW1wb3J0IHt2NyBhcyB1dWlkdjd9IGZyb20gJ3V1aWQnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEV2ZW50UmVmZXJlbmNlIHtcbiAgcmVhZG9ubHkgZXZlbnRfdHlwZTogRXZlbnRUeXBlO1xuICByZWFkb25seSBpZDogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEV2ZW50IGV4dGVuZHMgRXZlbnRSZWZlcmVuY2Uge1xuICB0b0NsaWVudEV2ZW50KCk6IENsaWVudEV2ZW50O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZpc2l0b3JFdmVudCBleHRlbmRzIEV2ZW50IHtcbiAgZXZlbnRfdHlwZTogRXZlbnRUeXBlLlZpc2l0b3I7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVmlzaXRvclJlZmVyZW5jZSBleHRlbmRzIEV2ZW50UmVmZXJlbmNlIHtcbiAgZXZlbnRfdHlwZTogRXZlbnRUeXBlLlZpc2l0b3I7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2Vzc2lvbkV2ZW50IGV4dGVuZHMgRXZlbnQge1xuICBwYXJlbnQ6IFZpc2l0b3JSZWZlcmVuY2U7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2Vzc2lvblJlZmVyZW5jZSBleHRlbmRzIEV2ZW50UmVmZXJlbmNlIHtcbiAgZXZlbnRfdHlwZTogRXZlbnRUeXBlLlNlc3Npb247XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VjdGlvbkV2ZW50IGV4dGVuZHMgRXZlbnQge1xuICBldmVudF90eXBlOiBFdmVudFR5cGUuU2VjdGlvbjtcbiAgcGFyZW50OiBTZXNzaW9uUmVmZXJlbmNlO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNlY3Rpb25SZWZlcmVuY2UgZXh0ZW5kcyBFdmVudFJlZmVyZW5jZSB7XG4gIGV2ZW50X3R5cGU6IEV2ZW50VHlwZS5TZWN0aW9uO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENsaWNrRXZlbnQgZXh0ZW5kcyBFdmVudCB7XG4gIGV2ZW50X3R5cGU6IEV2ZW50VHlwZS5DbGljaztcbiAgcGFyZW50OiBTZWN0aW9uUmVmZXJlbmNlO1xufVxuXG5leHBvcnQgY2xhc3MgVmlzaXRvciBpbXBsZW1lbnRzIFZpc2l0b3JFdmVudCwgVmlzaXRvclJlZmVyZW5jZSB7XG4gIHJlYWRvbmx5IGV2ZW50X3R5cGU6IEV2ZW50VHlwZS5WaXNpdG9yO1xuICByZWFkb25seSBpZDogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuZXZlbnRfdHlwZSA9IEV2ZW50VHlwZS5WaXNpdG9yO1xuICAgIHRoaXMuaWQgPSB1dWlkdjcoKTtcbiAgfVxuICBcbiAgdG9DbGllbnRFdmVudCgpOiBDbGllbnRFdmVudCB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHQ6IHRoaXMuZXZlbnRfdHlwZSxcbiAgICAgIGk6IHRoaXMuaWQsXG4gICAgICBhOiB1bmRlZmluZWQsXG4gICAgfTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgU2Vzc2lvbiBpbXBsZW1lbnRzIFNlc3Npb25FdmVudCwgU2Vzc2lvblJlZmVyZW5jZSB7XG4gIHJlYWRvbmx5IGV2ZW50X3R5cGU6IEV2ZW50VHlwZS5TZXNzaW9uO1xuICByZWFkb25seSBpZDogc3RyaW5nO1xuICByZWFkb25seSBwYXJlbnQ6IFZpc2l0b3JSZWZlcmVuY2U7XG5cbiAgY29uc3RydWN0b3IocGFyZW50OiBWaXNpdG9yUmVmZXJlbmNlKSB7XG4gICAgdGhpcy5ldmVudF90eXBlID0gRXZlbnRUeXBlLlNlc3Npb247XG4gICAgdGhpcy5pZCA9IHV1aWR2NygpO1xuICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICB9XG4gIFxuICB0b0NsaWVudEV2ZW50KCk6IENsaWVudEV2ZW50IHtcbiAgICBjb25zdCBhdHRyczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHsgcGFyZW50OiB0aGlzLnBhcmVudC5pZCB9O1xuICAgIHJldHVybiB7XG4gICAgICB0OiB0aGlzLmV2ZW50X3R5cGUsXG4gICAgICBpOiB0aGlzLmlkLFxuICAgICAgYTogYXR0cnMsXG4gICAgfTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgU2VjdGlvbiBpbXBsZW1lbnRzIFNlY3Rpb25FdmVudCwgU2VjdGlvblJlZmVyZW5jZSB7XG4gIHJlYWRvbmx5IGV2ZW50X3R5cGU6IEV2ZW50VHlwZS5TZWN0aW9uO1xuICByZWFkb25seSBpZDogc3RyaW5nO1xuICByZWFkb25seSBwYXJlbnQ6IFNlc3Npb25SZWZlcmVuY2U7XG5cbiAgY29uc3RydWN0b3IocGFyZW50OiBTZXNzaW9uUmVmZXJlbmNlKSB7XG4gICAgdGhpcy5ldmVudF90eXBlID0gRXZlbnRUeXBlLlNlY3Rpb247XG4gICAgdGhpcy5pZCA9IHV1aWR2NygpO1xuICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICB9XG4gIFxuICB0b0NsaWVudEV2ZW50KCk6IENsaWVudEV2ZW50IHtcbiAgICBjb25zdCBhdHRyczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHsgcGFyZW50OiB0aGlzLnBhcmVudC5pZCB9O1xuICAgIHJldHVybiB7XG4gICAgICB0OiB0aGlzLmV2ZW50X3R5cGUsXG4gICAgICBpOiB0aGlzLmlkLFxuICAgICAgYTogYXR0cnMsXG4gICAgfTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQ2xpY2sgaW1wbGVtZW50cyBDbGlja0V2ZW50IHtcbiAgcmVhZG9ubHkgZXZlbnRfdHlwZTogRXZlbnRUeXBlLkNsaWNrO1xuICByZWFkb25seSBpZDogc3RyaW5nO1xuICByZWFkb25seSBwYXJlbnQ6IFNlY3Rpb25SZWZlcmVuY2U7XG5cbiAgY29uc3RydWN0b3IocGFyZW50OiBTZWN0aW9uUmVmZXJlbmNlKSB7XG4gICAgdGhpcy5ldmVudF90eXBlID0gRXZlbnRUeXBlLkNsaWNrO1xuICAgIHRoaXMuaWQgPSB1dWlkdjcoKTtcbiAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgfVxuICBcbiAgdG9DbGllbnRFdmVudCgpOiBDbGllbnRFdmVudCB7XG4gICAgY29uc3QgYXR0cnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7IHBhcmVudDogdGhpcy5wYXJlbnQuaWQgfTtcbiAgICByZXR1cm4ge1xuICAgICAgdDogdGhpcy5ldmVudF90eXBlLFxuICAgICAgaTogdGhpcy5pZCxcbiAgICAgIGE6IGF0dHJzLFxuICAgIH07XG4gIH1cbn1cbiIsImltcG9ydCB7IFRvQ2xpZW50RXZlbnQgfSBmcm9tIFwiLi9DbGllbnRFdmVudFwiO1xuaW1wb3J0IHsgRXZlbnRQdWJsaXNoZXIsIEV2ZW50UHVibGlzaEVycm9yLCBFdmVudFB1Ymxpc2hSZXN1bHQgfSBmcm9tIFwiLi9FdmVudFB1Ymxpc2hlclwiO1xuXG5leHBvcnQgY2xhc3MgSHR0cEV2ZW50UHVibGlzaGVyIGltcGxlbWVudHMgRXZlbnRQdWJsaXNoZXIge1xuICBwcml2YXRlIGFwaV9rZXk6IHN0cmluZztcbiAgcHJpdmF0ZSBlbmRwb2ludDogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKGFwaV9rZXk6IHN0cmluZywgaG9zdDogc3RyaW5nKSB7XG4gICAgdGhpcy5hcGlfa2V5ID0gYXBpX2tleTtcbiAgICB0aGlzLmVuZHBvaW50ID0gaG9zdCArICcvbXVsdGknO1xuICB9XG5cbiAgYXN5bmMgcHVibGlzaChldmVudHM6IFRvQ2xpZW50RXZlbnRbXSk6IFByb21pc2U8RXZlbnRQdWJsaXNoUmVzdWx0PiB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh0aGlzLmNyZWF0ZVJlcXVlc3QoZXZlbnRzKSk7XG4gICAgXG4gICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICByZXR1cm4geyBjb3VudDogZXZlbnRzLmxlbmd0aCB9O1xuICAgIH1cbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IDUwMCkge1xuICAgICAgcmV0dXJuIEV2ZW50UHVibGlzaEVycm9yLkludGVybmFsU2VydmVyRXJyb3I7XG4gICAgfVxuICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT0gNDAwKSB7XG4gICAgICByZXR1cm4gRXZlbnRQdWJsaXNoRXJyb3IuQmFkUmVxdWVzdDtcbiAgICB9XG4gICAgcmV0dXJuIEV2ZW50UHVibGlzaEVycm9yLlRpbWVvdXQ7XG4gIH1cblxuICBwcml2YXRlIGNyZWF0ZVJlcXVlc3QoZXZlbnRzOiBUb0NsaWVudEV2ZW50W10pOiBSZXF1ZXN0IHtcbiAgICByZXR1cm4gbmV3IFJlcXVlc3QodGhpcy5lbmRwb2ludCwge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBtb2RlOiAnY29ycycsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiY29udGVudC10eXBlXCI6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgXCJhcGkta2V5XCI6IHRoaXMuYXBpX2tleSxcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShldmVudHMubWFwKGUgPT4gZS50b0NsaWVudEV2ZW50KCkpKSxcbiAgICB9KTtcbiAgfVxuXG59Il0sIm5hbWVzIjpbIkV2ZW50VHlwZSIsImdldFJhbmRvbVZhbHVlcyIsInJuZHM4IiwiVWludDhBcnJheSIsInJuZyIsImNyeXB0byIsIkVycm9yIiwiYmluZCIsImJ5dGVUb0hleCIsImkiLCJwdXNoIiwidG9TdHJpbmciLCJzbGljZSIsIl9zdGF0ZSIsInY3Qnl0ZXMiLCJybmRzIiwibXNlY3MiLCJzZXEiLCJidWYiLCJvZmZzZXQiLCJsZW5ndGgiLCJSYW5nZUVycm9yIiwiRGF0ZSIsIm5vdyIsIm9wdGlvbnMiLCJieXRlcyIsInJhbmRvbSIsInN0YXRlIiwidXBkYXRlVjdTdGF0ZSIsImFyciIsInRvTG93ZXJDYXNlIiwidW5zYWZlU3RyaW5naWZ5IiwiRXZlbnRQdWJsaXNoRXJyb3IiLCJ2aXNpdG9yIiwiY29uc3RydWN0b3IiLCJ0aGlzIiwiZXZlbnRfdHlwZSIsIlZpc2l0b3IiLCJpZCIsInRvQ2xpZW50RXZlbnQiLCJ0IiwiYSIsInVuZGVmaW5lZCIsInNlc3Npb24iLCJwYXJlbnQiLCJTZXNzaW9uIiwiYXR0cnMiLCJzZWN0aW9uIiwiU2VjdGlvbiIsImNsaWNrIiwiQ2xpY2siLCJhcGlfa2V5IiwiaG9zdCIsImVuZHBvaW50IiwicHVibGlzaCIsImV2ZW50cyIsInJlc3BvbnNlIiwiZmV0Y2giLCJjcmVhdGVSZXF1ZXN0Iiwib2siLCJjb3VudCIsInN0YXR1cyIsIkludGVybmFsU2VydmVyRXJyb3IiLCJCYWRSZXF1ZXN0IiwiVGltZW91dCIsIlJlcXVlc3QiLCJtZXRob2QiLCJtb2RlIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwibWFwIiwiZSJdLCJzb3VyY2VSb290IjoiIn0=