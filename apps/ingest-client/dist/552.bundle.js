(()=>{"use strict";var e,t;!function(e){e[e.BadRequest=0]="BadRequest",e[e.ConfigurationError=1]="ConfigurationError",e[e.InternalServerError=2]="InternalServerError",e[e.Timeout=3]="Timeout"}(e||(e={})),function(e){e[e.Invalid=0]="Invalid",e[e.InvalidApiKey=1]="InvalidApiKey",e[e.InvalidHost=2]="InvalidHost",e[e.Success=3]="Success"}(t||(t={}));var s;class i{constructor(e){if(function(e){if(e.api_key.trim().length<1)return t.InvalidApiKey;const s=URL.parse(e.host);return null==s||s.pathname.length>1||s.search.length>0||s.hash.length>0?t.InvalidHost:t.Success}(e)!=t.Success)throw new Error("Invalid Event Publisher Configuration");this.api_key=e.api_key,this.endpoint=e.host+"/multi"}publish(t){return s=this,i=void 0,n=function*(){const s=yield fetch(this.createRequest(t));return s.ok?{count:t.length}:500==s.status?e.InternalServerError:400==s.status?e.BadRequest:e.Timeout},new((r=void 0)||(r=Promise))((function(e,t){function o(e){try{a(n.next(e))}catch(e){t(e)}}function u(e){try{a(n.throw(e))}catch(e){t(e)}}function a(t){var s;t.done?e(t.value):(s=t.value,s instanceof r?s:new r((function(e){e(s)}))).then(o,u)}a((n=n.apply(s,i||[])).next())}));var s,i,r,n}createRequest(e){return new Request(this.endpoint,{method:"POST",mode:"cors",headers:{"content-type":"application/json","api-key":this.api_key},priority:"low",keepalive:!0,body:JSON.stringify(e)})}}!function(e){e[e.ConfigureRequest=0]="ConfigureRequest",e[e.ConfigureResult=1]="ConfigureResult",e[e.PublishError=2]="PublishError",e[e.PublishRequest=3]="PublishRequest",e[e.PublishResult=4]="PublishResult"}(s||(s={}));const r=self,n=new class{constructor(e){this.httpPublisher=void 0,this.workerContext=e}configurePublisher(e){try{this.httpPublisher=new i(e.config)}catch(i){const r={configurationState:t.Invalid,id:e.id,messageType:s.ConfigureResult};this.postResponse(r)}}publishEvents(t){if(null!=this.httpPublisher)if(t.events.length<1){const i={id:t.id,errorType:e.BadRequest,errorMessage:"Request to publish empty set of events",messageType:s.PublishError};this.postResponse(i)}else this.httpPublisher.publish(t.events).then((e=>this.publishResult(t.id,e)));else{const i={id:t.id,errorType:e.ConfigurationError,errorMessage:"Publish event request received prior to configuration",messageType:s.PublishError};this.postResponse(i)}}publishResult(e,t){const i={id:e,messageType:s.PublishResult,result:t};this.postResponse(i)}postResponse(e){this.workerContext.postMessage(e)}proxyMessage(e){const t=e.data;t.messageType==s.ConfigureRequest?this.configurePublisher(t):t.messageType==s.PublishRequest&&this.publishEvents(t)}}(r);r.addEventListener("message",(e=>n.proxyMessage(e)))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUMvQkwsVUFFRjVDLEtBQUtxQyxhQUFhVyxFQUNwQixDQUVRLFlBQUFYLENBQWFhLEdBQ25CbEQsS0FBS3lCLGNBQWMwQixZQUFZRCxFQUNqQyxDQUVBLFlBQUFFLENBQWFGLEdBQ1gsTUFBTUcsRUFBZ0JILEVBQVFJLEtBSTFCRCxFQUFjbEIsYUFBZXJELEVBQWtCeUUsaUJBQ2pEdkQsS0FBSzRCLG1CQUFtQnlCLEdBQ2ZBLEVBQWNsQixhQUFlckQsRUFBa0IwRSxnQkFDeER4RCxLQUFLc0MsY0FBY2UsRUFFdkIsR0RwRjhDL0IsR0FDaERBLEVBQUltQyxpQkFBaUIsV0FBWUMsR0FBTWxDLEVBQWU0QixhQUFhTSxJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaW5nZXN0LWNsaWVudC8uL3NyYy9FdmVudFB1Ymxpc2hlci9FdmVudFB1Ymxpc2hlci50cyIsIndlYnBhY2s6Ly9pbmdlc3QtY2xpZW50Ly4vc3JjL0V2ZW50UHVibGlzaGVyL1dvcmtlck1lc3NhZ2UudHMiLCJ3ZWJwYWNrOi8vaW5nZXN0LWNsaWVudC8uL3NyYy9FdmVudFB1Ymxpc2hlci9IdHRwRXZlbnRQdWJsaXNoZXIudHMiLCJ3ZWJwYWNrOi8vaW5nZXN0LWNsaWVudC8uL3NyYy9FdmVudFB1Ymxpc2hlci9Xb3JrZXJQdWJsaXNoZXIuanMiLCJ3ZWJwYWNrOi8vaW5nZXN0LWNsaWVudC8uL3NyYy9FdmVudFB1Ymxpc2hlci9Xb3JrZXJQdWJsaXNoZXJQcm94eS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQdWJsaXNoRXZlbnQgfSBmcm9tIFwiLi9QdWJsaXNoRXZlbnRcIjtcblxuZXhwb3J0IGludGVyZmFjZSBFdmVudFB1Ymxpc2hTdWNjZXNzIHtcbiAgY291bnQ6IG51bWJlcjtcbn1cblxuZXhwb3J0IGVudW0gRXZlbnRQdWJsaXNoRXJyb3Ige1xuICBCYWRSZXF1ZXN0LFxuICBDb25maWd1cmF0aW9uRXJyb3IsXG4gIEludGVybmFsU2VydmVyRXJyb3IsXG4gIFRpbWVvdXQsXG59XG5cbmV4cG9ydCB0eXBlIEV2ZW50UHVibGlzaFJlc3VsdCA9IEV2ZW50UHVibGlzaFN1Y2Nlc3MgfCBFdmVudFB1Ymxpc2hFcnJvcjtcblxuZXhwb3J0IGludGVyZmFjZSBFdmVudFB1Ymxpc2hlciB7XG4gIHB1Ymxpc2goZXZlbnRzOiBQdWJsaXNoRXZlbnRbXSk6IFByb21pc2U8RXZlbnRQdWJsaXNoUmVzdWx0Pjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFdmVudFB1Ymxpc2hlckNvbmZpZ3VyYXRpb24ge1xuICBhcGlfa2V5OiBzdHJpbmc7XG4gIGhvc3Q6IHN0cmluZztcbn1cblxuZXhwb3J0IGVudW0gRXZlbnRQdWJsaXNoZXJDb25maWd1cmF0aW9uU3RhdGUge1xuICBJbnZhbGlkLFxuICBJbnZhbGlkQXBpS2V5LFxuICBJbnZhbGlkSG9zdCxcbiAgU3VjY2Vzcyxcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlRXZlbnRQdWJsaXNoZXJDb25maWd1cmF0aW9uKFxuICBjb25maWc6IEV2ZW50UHVibGlzaGVyQ29uZmlndXJhdGlvbixcbik6IEV2ZW50UHVibGlzaGVyQ29uZmlndXJhdGlvblN0YXRlIHtcbiAgaWYgKGNvbmZpZy5hcGlfa2V5LnRyaW0oKS5sZW5ndGggPCAxKSB7XG4gICAgcmV0dXJuIEV2ZW50UHVibGlzaGVyQ29uZmlndXJhdGlvblN0YXRlLkludmFsaWRBcGlLZXk7XG4gIH1cbiAgY29uc3QgaG9zdCA9IFVSTC5wYXJzZShjb25maWcuaG9zdCk7XG4gIGlmIChob3N0ID09IG51bGwpIHtcbiAgICByZXR1cm4gRXZlbnRQdWJsaXNoZXJDb25maWd1cmF0aW9uU3RhdGUuSW52YWxpZEhvc3Q7XG4gIH1cbiAgaWYgKFxuICAgIGhvc3QucGF0aG5hbWUubGVuZ3RoID4gMSB8fFxuICAgIGhvc3Quc2VhcmNoLmxlbmd0aCA+IDAgfHxcbiAgICBob3N0Lmhhc2gubGVuZ3RoID4gMFxuICApIHtcbiAgICByZXR1cm4gRXZlbnRQdWJsaXNoZXJDb25maWd1cmF0aW9uU3RhdGUuSW52YWxpZEhvc3Q7XG4gIH1cbiAgcmV0dXJuIEV2ZW50UHVibGlzaGVyQ29uZmlndXJhdGlvblN0YXRlLlN1Y2Nlc3M7XG59XG4iLCJpbXBvcnQge1xuICBFdmVudFB1Ymxpc2hlckNvbmZpZ3VyYXRpb24sXG4gIEV2ZW50UHVibGlzaGVyQ29uZmlndXJhdGlvblN0YXRlLFxuICBFdmVudFB1Ymxpc2hFcnJvcixcbiAgRXZlbnRQdWJsaXNoUmVzdWx0LFxufSBmcm9tIFwiLi9FdmVudFB1Ymxpc2hlclwiO1xuaW1wb3J0IHsgUHVibGlzaEV2ZW50IH0gZnJvbSBcIi4vUHVibGlzaEV2ZW50XCI7XG5cbmV4cG9ydCBlbnVtIFdvcmtlck1lc3NhZ2VUeXBlIHtcbiAgQ29uZmlndXJlUmVxdWVzdCxcbiAgQ29uZmlndXJlUmVzdWx0LFxuICBQdWJsaXNoRXJyb3IsXG4gIFB1Ymxpc2hSZXF1ZXN0LFxuICBQdWJsaXNoUmVzdWx0LFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFdvcmtlck1lc3NhZ2Uge1xuICBpZDogc3RyaW5nO1xuICBtZXNzYWdlVHlwZTogV29ya2VyTWVzc2FnZVR5cGU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgV29ya2VyQ29uZmlndXJhdGlvblJlcXVlc3RNZXNzYWdlIGV4dGVuZHMgV29ya2VyTWVzc2FnZSB7XG4gIG1lc3NhZ2VUeXBlOiBXb3JrZXJNZXNzYWdlVHlwZS5Db25maWd1cmVSZXF1ZXN0O1xuICBjb25maWc6IEV2ZW50UHVibGlzaGVyQ29uZmlndXJhdGlvbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBXb3JrZXJDb25maWd1cmF0aW9uUmVzdWx0TWVzc2FnZSBleHRlbmRzIFdvcmtlck1lc3NhZ2Uge1xuICBtZXNzYWdlVHlwZTogV29ya2VyTWVzc2FnZVR5cGUuQ29uZmlndXJlUmVzdWx0O1xuICBjb25maWd1cmF0aW9uU3RhdGU6IEV2ZW50UHVibGlzaGVyQ29uZmlndXJhdGlvblN0YXRlO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFdvcmtlclB1Ymxpc2hFcnJvck1lc3NhZ2UgZXh0ZW5kcyBXb3JrZXJNZXNzYWdlIHtcbiAgbWVzc2FnZVR5cGU6IFdvcmtlck1lc3NhZ2VUeXBlLlB1Ymxpc2hFcnJvcjtcbiAgZXJyb3JUeXBlOiBFdmVudFB1Ymxpc2hFcnJvcjtcbiAgZXJyb3JNZXNzYWdlOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgV29ya2VyUHVibGlzaFJlcXVlc3RNZXNzYWdlIGV4dGVuZHMgV29ya2VyTWVzc2FnZSB7XG4gIG1lc3NhZ2VUeXBlOiBXb3JrZXJNZXNzYWdlVHlwZS5QdWJsaXNoUmVxdWVzdDtcbiAgZXZlbnRzOiBQdWJsaXNoRXZlbnRbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBXb3JrZXJQdWJsaXNoUmVzdWx0TWVzc2FnZSBleHRlbmRzIFdvcmtlck1lc3NhZ2Uge1xuICBtZXNzYWdlVHlwZTogV29ya2VyTWVzc2FnZVR5cGUuUHVibGlzaFJlc3VsdDtcbiAgcmVzdWx0OiBFdmVudFB1Ymxpc2hSZXN1bHQ7XG59XG4iLCJpbXBvcnQgeyBQdWJsaXNoRXZlbnQgfSBmcm9tIFwiLi9QdWJsaXNoRXZlbnRcIjtcbmltcG9ydCB7XG4gIEV2ZW50UHVibGlzaGVyLFxuICBFdmVudFB1Ymxpc2hlckNvbmZpZ3VyYXRpb24sXG4gIEV2ZW50UHVibGlzaGVyQ29uZmlndXJhdGlvblN0YXRlLFxuICBFdmVudFB1Ymxpc2hFcnJvcixcbiAgRXZlbnRQdWJsaXNoUmVzdWx0LFxuICB2YWxpZGF0ZUV2ZW50UHVibGlzaGVyQ29uZmlndXJhdGlvbixcbn0gZnJvbSBcIi4vRXZlbnRQdWJsaXNoZXJcIjtcblxuZXhwb3J0IGNsYXNzIEh0dHBFdmVudFB1Ymxpc2hlciBpbXBsZW1lbnRzIEV2ZW50UHVibGlzaGVyIHtcbiAgcHJpdmF0ZSBhcGlfa2V5OiBzdHJpbmc7XG4gIHByaXZhdGUgZW5kcG9pbnQ6IHN0cmluZztcblxuICBjb25zdHJ1Y3Rvcihjb25maWc6IEV2ZW50UHVibGlzaGVyQ29uZmlndXJhdGlvbikge1xuICAgIGlmIChcbiAgICAgIHZhbGlkYXRlRXZlbnRQdWJsaXNoZXJDb25maWd1cmF0aW9uKGNvbmZpZykgIT1cbiAgICAgIEV2ZW50UHVibGlzaGVyQ29uZmlndXJhdGlvblN0YXRlLlN1Y2Nlc3NcbiAgICApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgRXZlbnQgUHVibGlzaGVyIENvbmZpZ3VyYXRpb25cIik7XG4gICAgfVxuICAgIHRoaXMuYXBpX2tleSA9IGNvbmZpZy5hcGlfa2V5O1xuICAgIHRoaXMuZW5kcG9pbnQgPSBjb25maWcuaG9zdCArIFwiL211bHRpXCI7XG4gIH1cblxuICBhc3luYyBwdWJsaXNoKGV2ZW50czogUHVibGlzaEV2ZW50W10pOiBQcm9taXNlPEV2ZW50UHVibGlzaFJlc3VsdD4ge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godGhpcy5jcmVhdGVSZXF1ZXN0KGV2ZW50cykpO1xuXG4gICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICByZXR1cm4geyBjb3VudDogZXZlbnRzLmxlbmd0aCB9O1xuICAgIH1cblxuICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT0gNTAwKSB7XG4gICAgICByZXR1cm4gRXZlbnRQdWJsaXNoRXJyb3IuSW50ZXJuYWxTZXJ2ZXJFcnJvcjtcbiAgICB9XG5cbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IDQwMCkge1xuICAgICAgcmV0dXJuIEV2ZW50UHVibGlzaEVycm9yLkJhZFJlcXVlc3Q7XG4gICAgfVxuXG4gICAgcmV0dXJuIEV2ZW50UHVibGlzaEVycm9yLlRpbWVvdXQ7XG4gIH1cblxuICBwcml2YXRlIGNyZWF0ZVJlcXVlc3QoZXZlbnRzOiBQdWJsaXNoRXZlbnRbXSk6IFJlcXVlc3Qge1xuICAgIHJldHVybiBuZXcgUmVxdWVzdCh0aGlzLmVuZHBvaW50LCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgbW9kZTogXCJjb3JzXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiY29udGVudC10eXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICBcImFwaS1rZXlcIjogdGhpcy5hcGlfa2V5LFxuICAgICAgfSxcbiAgICAgIHByaW9yaXR5OiBcImxvd1wiLFxuICAgICAga2VlcGFsaXZlOiB0cnVlLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZXZlbnRzKSxcbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgV29ya2VyUHVibGlzaGVyUHJveHkgfSBmcm9tIFwiLi9Xb3JrZXJQdWJsaXNoZXJQcm94eVwiO1xuXG4vKipAdHlwZSB7RGVkaWNhdGVkV29ya2VyR2xvYmFsU2NvcGV9ICovXG5jb25zdCBjdHggPSBzZWxmO1xuY29uc3QgcHVibGlzaGVyUHJveHkgPSBuZXcgV29ya2VyUHVibGlzaGVyUHJveHkoY3R4KTtcbmN0eC5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCAoZSkgPT4gcHVibGlzaGVyUHJveHkucHJveHlNZXNzYWdlKGUpKTtcbiIsImltcG9ydCB7IEh0dHBFdmVudFB1Ymxpc2hlciB9IGZyb20gXCIuL0h0dHBFdmVudFB1Ymxpc2hlclwiO1xuaW1wb3J0IHtcbiAgRXZlbnRQdWJsaXNoZXJDb25maWd1cmF0aW9uU3RhdGUsXG4gIEV2ZW50UHVibGlzaEVycm9yLFxuICBFdmVudFB1Ymxpc2hSZXN1bHQsXG59IGZyb20gXCIuL0V2ZW50UHVibGlzaGVyXCI7XG5pbXBvcnQge1xuICBXb3JrZXJDb25maWd1cmF0aW9uUmVxdWVzdE1lc3NhZ2UsXG4gIFdvcmtlckNvbmZpZ3VyYXRpb25SZXN1bHRNZXNzYWdlLFxuICBXb3JrZXJQdWJsaXNoRXJyb3JNZXNzYWdlLFxuICBXb3JrZXJNZXNzYWdlLFxuICBXb3JrZXJNZXNzYWdlVHlwZSxcbiAgV29ya2VyUHVibGlzaFJlcXVlc3RNZXNzYWdlLFxuICBXb3JrZXJQdWJsaXNoUmVzdWx0TWVzc2FnZSxcbn0gZnJvbSBcIi4vV29ya2VyTWVzc2FnZVwiO1xuXG5leHBvcnQgY2xhc3MgV29ya2VyUHVibGlzaGVyUHJveHkge1xuICBwcml2YXRlIGh0dHBQdWJsaXNoZXI6IEh0dHBFdmVudFB1Ymxpc2hlciB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgcHJpdmF0ZSB3b3JrZXJDb250ZXh0OiBEZWRpY2F0ZWRXb3JrZXJHbG9iYWxTY29wZTtcblxuICBjb25zdHJ1Y3Rvcih3b3JrZXJDb250ZXh0OiBEZWRpY2F0ZWRXb3JrZXJHbG9iYWxTY29wZSkge1xuICAgIHRoaXMud29ya2VyQ29udGV4dCA9IHdvcmtlckNvbnRleHQ7XG4gIH1cblxuICBwcml2YXRlIGNvbmZpZ3VyZVB1Ymxpc2hlcihcbiAgICBjb25maWdNZXNzYWdlOiBXb3JrZXJDb25maWd1cmF0aW9uUmVxdWVzdE1lc3NhZ2UsXG4gICk6IHZvaWQge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmh0dHBQdWJsaXNoZXIgPSBuZXcgSHR0cEV2ZW50UHVibGlzaGVyKGNvbmZpZ01lc3NhZ2UuY29uZmlnKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnN0IGVyck1lc3NhZ2U6IFdvcmtlckNvbmZpZ3VyYXRpb25SZXN1bHRNZXNzYWdlID0ge1xuICAgICAgICBjb25maWd1cmF0aW9uU3RhdGU6IEV2ZW50UHVibGlzaGVyQ29uZmlndXJhdGlvblN0YXRlLkludmFsaWQsXG4gICAgICAgIGlkOiBjb25maWdNZXNzYWdlLmlkLFxuICAgICAgICBtZXNzYWdlVHlwZTogV29ya2VyTWVzc2FnZVR5cGUuQ29uZmlndXJlUmVzdWx0LFxuICAgICAgfTtcbiAgICAgIHRoaXMucG9zdFJlc3BvbnNlKGVyck1lc3NhZ2UpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgcHVibGlzaEV2ZW50cyhwdWJsaXNoTWVzc2FnZTogV29ya2VyUHVibGlzaFJlcXVlc3RNZXNzYWdlKSB7XG4gICAgaWYgKHRoaXMuaHR0cFB1Ymxpc2hlciA9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZTogV29ya2VyUHVibGlzaEVycm9yTWVzc2FnZSA9IHtcbiAgICAgICAgaWQ6IHB1Ymxpc2hNZXNzYWdlLmlkLFxuICAgICAgICBlcnJvclR5cGU6IEV2ZW50UHVibGlzaEVycm9yLkNvbmZpZ3VyYXRpb25FcnJvcixcbiAgICAgICAgZXJyb3JNZXNzYWdlOiBcIlB1Ymxpc2ggZXZlbnQgcmVxdWVzdCByZWNlaXZlZCBwcmlvciB0byBjb25maWd1cmF0aW9uXCIsXG4gICAgICAgIG1lc3NhZ2VUeXBlOiBXb3JrZXJNZXNzYWdlVHlwZS5QdWJsaXNoRXJyb3IsXG4gICAgICB9O1xuICAgICAgdGhpcy5wb3N0UmVzcG9uc2UoZXJyb3JNZXNzYWdlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHB1Ymxpc2hNZXNzYWdlLmV2ZW50cy5sZW5ndGggPCAxKSB7XG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2U6IFdvcmtlclB1Ymxpc2hFcnJvck1lc3NhZ2UgPSB7XG4gICAgICAgIGlkOiBwdWJsaXNoTWVzc2FnZS5pZCxcbiAgICAgICAgZXJyb3JUeXBlOiBFdmVudFB1Ymxpc2hFcnJvci5CYWRSZXF1ZXN0LFxuICAgICAgICBlcnJvck1lc3NhZ2U6IFwiUmVxdWVzdCB0byBwdWJsaXNoIGVtcHR5IHNldCBvZiBldmVudHNcIixcbiAgICAgICAgbWVzc2FnZVR5cGU6IFdvcmtlck1lc3NhZ2VUeXBlLlB1Ymxpc2hFcnJvcixcbiAgICAgIH07XG4gICAgICB0aGlzLnBvc3RSZXNwb25zZShlcnJvck1lc3NhZ2UpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmh0dHBQdWJsaXNoZXJcbiAgICAgIC5wdWJsaXNoKHB1Ymxpc2hNZXNzYWdlLmV2ZW50cylcbiAgICAgIC50aGVuKChyZXN1bHQpID0+IHRoaXMucHVibGlzaFJlc3VsdChwdWJsaXNoTWVzc2FnZS5pZCwgcmVzdWx0KSk7XG4gIH1cblxuICBwcml2YXRlIHB1Ymxpc2hSZXN1bHQobWVzc2FnZUlkOiBzdHJpbmcsIHJlc3VsdDogRXZlbnRQdWJsaXNoUmVzdWx0KSB7XG4gICAgY29uc3QgcmVzdWx0TWVzc2FnZTogV29ya2VyUHVibGlzaFJlc3VsdE1lc3NhZ2UgPSB7XG4gICAgICBpZDogbWVzc2FnZUlkLFxuICAgICAgbWVzc2FnZVR5cGU6IFdvcmtlck1lc3NhZ2VUeXBlLlB1Ymxpc2hSZXN1bHQsXG4gICAgICByZXN1bHQsXG4gICAgfTtcbiAgICB0aGlzLnBvc3RSZXNwb25zZShyZXN1bHRNZXNzYWdlKTtcbiAgfVxuXG4gIHByaXZhdGUgcG9zdFJlc3BvbnNlKG1lc3NhZ2U6IFdvcmtlck1lc3NhZ2UpIHtcbiAgICB0aGlzLndvcmtlckNvbnRleHQucG9zdE1lc3NhZ2UobWVzc2FnZSk7XG4gIH1cblxuICBwcm94eU1lc3NhZ2UobWVzc2FnZTogTWVzc2FnZUV2ZW50KSB7XG4gICAgY29uc3Qgd29ya2VyTWVzc2FnZSA9IG1lc3NhZ2UuZGF0YSBhc1xuICAgICAgfCBXb3JrZXJDb25maWd1cmF0aW9uUmVxdWVzdE1lc3NhZ2VcbiAgICAgIHwgV29ya2VyUHVibGlzaFJlcXVlc3RNZXNzYWdlO1xuXG4gICAgaWYgKHdvcmtlck1lc3NhZ2UubWVzc2FnZVR5cGUgPT0gV29ya2VyTWVzc2FnZVR5cGUuQ29uZmlndXJlUmVxdWVzdCkge1xuICAgICAgdGhpcy5jb25maWd1cmVQdWJsaXNoZXIod29ya2VyTWVzc2FnZSk7XG4gICAgfSBlbHNlIGlmICh3b3JrZXJNZXNzYWdlLm1lc3NhZ2VUeXBlID09IFdvcmtlck1lc3NhZ2VUeXBlLlB1Ymxpc2hSZXF1ZXN0KSB7XG4gICAgICB0aGlzLnB1Ymxpc2hFdmVudHMod29ya2VyTWVzc2FnZSk7XG4gICAgfVxuICB9XG59XG4iXSwibmFtZXMiOlsiRXZlbnRQdWJsaXNoRXJyb3IiLCJFdmVudFB1Ymxpc2hlckNvbmZpZ3VyYXRpb25TdGF0ZSIsIldvcmtlck1lc3NhZ2VUeXBlIiwiSHR0cEV2ZW50UHVibGlzaGVyIiwiY29uc3RydWN0b3IiLCJjb25maWciLCJhcGlfa2V5IiwidHJpbSIsImxlbmd0aCIsIkludmFsaWRBcGlLZXkiLCJob3N0IiwiVVJMIiwicGFyc2UiLCJwYXRobmFtZSIsInNlYXJjaCIsImhhc2giLCJJbnZhbGlkSG9zdCIsIlN1Y2Nlc3MiLCJ2YWxpZGF0ZUV2ZW50UHVibGlzaGVyQ29uZmlndXJhdGlvbiIsIkVycm9yIiwidGhpcyIsImVuZHBvaW50IiwicHVibGlzaCIsImV2ZW50cyIsInJlc3BvbnNlIiwiZmV0Y2giLCJjcmVhdGVSZXF1ZXN0Iiwib2siLCJjb3VudCIsInN0YXR1cyIsIkludGVybmFsU2VydmVyRXJyb3IiLCJCYWRSZXF1ZXN0IiwiVGltZW91dCIsIlJlcXVlc3QiLCJtZXRob2QiLCJtb2RlIiwiaGVhZGVycyIsInByaW9yaXR5Iiwia2VlcGFsaXZlIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJjdHgiLCJzZWxmIiwicHVibGlzaGVyUHJveHkiLCJ3b3JrZXJDb250ZXh0IiwiaHR0cFB1Ymxpc2hlciIsInVuZGVmaW5lZCIsImNvbmZpZ3VyZVB1Ymxpc2hlciIsImNvbmZpZ01lc3NhZ2UiLCJlcnIiLCJlcnJNZXNzYWdlIiwiY29uZmlndXJhdGlvblN0YXRlIiwiSW52YWxpZCIsImlkIiwibWVzc2FnZVR5cGUiLCJDb25maWd1cmVSZXN1bHQiLCJwb3N0UmVzcG9uc2UiLCJwdWJsaXNoRXZlbnRzIiwicHVibGlzaE1lc3NhZ2UiLCJlcnJvck1lc3NhZ2UiLCJlcnJvclR5cGUiLCJQdWJsaXNoRXJyb3IiLCJ0aGVuIiwicmVzdWx0IiwicHVibGlzaFJlc3VsdCIsIkNvbmZpZ3VyYXRpb25FcnJvciIsIm1lc3NhZ2VJZCIsInJlc3VsdE1lc3NhZ2UiLCJQdWJsaXNoUmVzdWx0IiwibWVzc2FnZSIsInBvc3RNZXNzYWdlIiwicHJveHlNZXNzYWdlIiwid29ya2VyTWVzc2FnZSIsImRhdGEiLCJDb25maWd1cmVSZXF1ZXN0IiwiUHVibGlzaFJlcXVlc3QiLCJhZGRFdmVudExpc3RlbmVyIiwiZSJdLCJzb3VyY2VSb290IjoiIn0=